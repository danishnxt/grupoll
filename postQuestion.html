<!DOCTYPE html>
<html>
<link rel="stylesheet" type="text/css" href="postQuestion.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet"><head>
</head>
<body>
<div class="background">
  <header class="app_header"></header>
  <center>
    <div class="title1">Post Question</div>
  <div class="what" id="genericText" > What's your question? </div>
  <input id="quesText"  class="inputbar" > </input>

  <div>
    <div class="what"> What is your user ID? </div>
    <input id="userIDText" class="inputbar"> </input>
  </div>

  <div>
     <h4 class="what"> How many answers would you like? </h4>
      <select id = "selector" onChange = "enabler()">
        <option> 2 </option>
        <option> 3 </option>
      </select>
  </div>

  <div>
    <input id="option_1" > Answer 1 </input>
  </div>
  <div>
    <input id="option_2" > Answer 2 </input>
  </div>
  <div>
    <input id="option_3" disabled = true> Answer 3 </input>
  </div>

  <button onClick="send()"> Send the question! </button>
  <div class="footer"></div>
  </center>
  </div>
</body>

<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript">

  const enabler = () => {
    console.log(document.getElementById("selector").value)
    if (document.getElementById("selector").value === "2") {
      document.getElementById("option_3").disabled = true
    } else {
      document.getElementById("option_3").disabled = false
    }
  }

  const socket = io();
  const myGenericCat = "5adc5269e5ab8524681e7ff5";

  const send = () => {
    sendValQ = {
      userID: document.getElementById("userIDText").value,
      questionStatement: document.getElementById("quesText").value,
      questionType: false,
      containsImage: false,
      containsVoice: false,
      imageLink: "",
      voiceLink: "",
      date: Date.now(),
      categoryID: myGenericCat,
      answerTimeLimit: Date.now()+300
    }

    socket.emit('msgQuestionPostRequest', sendValQ)
    socket.on('msgQuestionPostRequestConfirmed', payload => {

      if (document.getElementById('option_3').disabled === true){
        ans3 = ""
      } else {
        ans3 = document.getElementById('option_3').value
      }
      sendValA = {
        questionID: payload._id,
        option1: document.getElementById('option_1').value,
        option2: document.getElementById('option_2').value,
        option3: ans3,
        option1Link: "",
        option2Link: "",
        option3Link: ""
      }
      socket.emit('msgAnswerPostRequest', sendValA)
    })

    socket.on('msgQuestionPostRequestRejected', payload => {
      alert('something went terribly wrong :( ')
    })
  }

</script>
</html>
