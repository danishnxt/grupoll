<!DOCTYPE html>
<html>
<head>
	<title> GruPoll </title>
</head>

<body>
  <button> Logout </button>
  <div id="feed">Loading...</div>
	<ul id= "newsfeed" style="list-style-type:none"></ul>
  <button onclick="test()"> Test </button>
</body>

<script src="/socket.io/socket.io.js"></script>
<script src="/browserfs.min.js"></script>

<script type="text/javascript">
  BrowserFS.install(window);

  BrowserFS.configure({
    fs : "LocalStorage"
  }, e => {
    if (e) {
      throw e;
    }
  });

  const socket = io();

  const fs = require('fs');

  const switchToQuestion = (questionID) => {
    console.log(questionID);
    fs.writeFile('/current_question.txt', questionID, err => {
      window.open("http://localhost:3000/question");  
    });
  };

	const addQuestionEntry = (statement, questionID) => {
    const addElem = "<button onclick=\"switchToQuestion('" + questionID + "');\">" + statement + "</button>";
    console.log(addElem);
		document.getElementById("newsfeed").innerHTML += "<li>" + addElem + "</li>";
	};

  socket.on('msgUserFeedRetrieveRequestConfirmed', msg => {
    msg.forEach(val => {
      addQuestionEntry(val.statement, val._id);
    });
  });

  socket.emit('msgUserFeedRetrieveRequest', {});
</script>
</html>
